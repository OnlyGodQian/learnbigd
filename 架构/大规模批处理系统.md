# 大规模批处理系统

## MapReduce计算模型与架构

### MapReduce计算模式

归纳使用MapReduce机制来解决批处理任务中若干最常见的计算模式，在实际应用中大部分ETL任务都可以归结为这些计算模式或者其变体。

#### 求和模式（Summarization Pattern）

* 数值求和
* 记录求和

#### 过滤模式（Filtering Pattern）

从海量数据中筛选出满足一定条件的数据子集。

* 简单过滤
* Top10
  * 在map阶段找到局部top10，在reduce阶段找到全局top10，在实际使用中可以使用排序算法来实现，比如堆排序。

####组织数据模式（Data Organization Pattern）

很多应用需要对数据进行整理工作，比如转换数据格式、对数据进行分组归类、对数据进行全局排序等，这是组织数据模式发挥作用的应用场景。

* 数据分片
  * 将同一天的数据放到一起以进一步做后续数据分析
  * 将相同地区的记录分类到一起。
  * 中信放在Partition策略设计上
* 全局排序
  * map阶段将要排序的key,加上value原样输出即可
  * reduce如果只有一个，那么不需要做额外操作就可以直接得到全局排序结果
  * 如果有多个reducer，那么可以在partition做配置，比如将1-10000分给reducer1,10001-20000分给reducer2...

#### Join模式（Join Pattern）

所谓“join”，就是将两个不同数据集合内容根据相同外键进行信息融合的过程。

* Reduce-Side Join
  * 
* Map-Side Join

